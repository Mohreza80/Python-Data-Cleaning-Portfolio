# Python-Data-Cleaning-Portfolio# پروژه پاکسازی و تحلیل اولیه صورتحساب بانکی نمونه با پایتون

## توضیحات پروژه

این مخزن شامل یک اسکریپت پایتون (`bank_statement_cleaner.py`) است که برای پاکسازی، پردازش و انجام تحلیل‌های اولیه روی داده‌های نمونه یک صورتحساب بانکی طراحی شده است. داده‌های ورودی (ارائه نشده در این مخزن، اما نمونه ساختار در کد موجود است) در فرمت اکسل بوده و حاوی اطلاعات تراکنش‌ها به زبان فارسی و با تاریخ شمسی بودند که شامل ناهماهنگی‌ها و داده‌های نامرتب (مانند کدهای HTML، فرمت‌های عددی و تاریخی نامناسب، مقادیر خالی و ردیف‌های تکراری) می‌شدند.

هدف اصلی این پروژه، تبدیل داده‌های خام و نامنظم به یک مجموعه داده تمیز، ساختاریافته و آماده برای تحلیل‌های بعدی (مانند گزارش‌گیری مالیاتی یا تحلیل هزینه و درآمد) و همچنین استخراج اطلاعات کلیدی از تراکنش‌ها بوده است. این پروژه به عنوان نمونه کار برای نمایش مهارت در پردازش داده با پایتون انجام شده است.

## چالش‌ها و راه حل‌های پیاده‌سازی شده

* **خواندن فایل اکسل:** مدیریت خواندن فایل `.xlsx` با در نظر گرفتن ردیف هدر صحیح با استفاده از `pandas.read_excel`.
* **پاکسازی داده‌های عددی:** حذف کاراکترهای غیر عددی (مانند کاما `,`) از ستون‌های مبلغ (واریز، برداشت، مانده) و تبدیل آن‌ها به نوع عددی (`float`) با استفاده از توابع رشته‌ای پانداز و `pd.to_numeric`.
* **تبدیل تاریخ شمسی:** تبدیل ستون تاریخ از فرمت شمسی (`YYYY/MM/DD` یا مشابه) به فرمت استاندارد میلادی (`datetime`) با استفاده از کتابخانه `jdatetime` و `pd.to_datetime`.
* **مدیریت مقادیر گم‌شده (NaN):** شناسایی و حذف ردیف‌هایی که در ستون‌های کلیدی (تاریخ، واریز، برداشت، مانده) اطلاعات ناقص داشتند (`dropna`).
* **حذف ردیف‌های تکراری:** شناسایی و حذف ردیف‌های کاملاً یکسان (`drop_duplicates`).
* **پاکسازی HTML:** حذف کامل تگ‌ها و کدهای HTML از ستون‌های متنی (مانند شرح سند، تخصص، علایق و...) با استفاده از کتابخانه `BeautifulSoup` برای استخراج متن خالص.
* **دسته‌بندی تراکنش‌ها:** ایجاد یک تابع در پایتون برای تخصیص دسته‌بندی‌های معنی‌دار (مثل 'قسط وام', 'سود بانکی', 'خرید POS', 'انتقال وجه', 'کارمزد بانکی', 'پرداخت قبض' و...) به هر تراکنش بر اساس **کلمات کلیدی فارسی** موجود در ستون 'شرح سند'.
* **محاسبات تحلیلی:** ایجاد ستون‌های جدید مانند 'Amount' (مبلغ تراکنش)، 'Income' (درآمد) و 'Expense' (هزینه) و انجام محاسبات اولیه مانند مجموع واریز/برداشت/خالص هر دسته و میانگین مبلغ خرید POS با استفاده از `groupby` و توابع تجمعی پانداز.
* **مصورسازی با متن فارسی:** رفع مشکل رایج نمایش نادرست متن فارسی در نمودارهای `matplotlib` با استفاده از کتابخانه‌های `arabic-reshaper` و `python-bidi` و رسم نمودار روند ماهانه درآمد در مقابل دسته‌های اصلی هزینه.

## قابلیت‌های اسکریپت (`bank_statement_cleaner.py`)

* خواندن فایل اکسل ورودی.
* حذف ستون‌ها و ردیف‌های خالی و تکراری.
* پاکسازی و تبدیل ستون‌های مبلغ و تاریخ.
* پاکسازی تگ‌های HTML از ستون‌های متنی مشخص شده.
* ایجاد ستون‌های Amount, Income, Expense.
* ایجاد ستون Category با دسته‌بندی تراکنش‌ها.
* محاسبه و چاپ تحلیل‌های آماری اولیه بر اساس دسته‌بندی.
* رسم و ذخیره نمودار روند ماهانه درآمد و هزینه به تفکیک دسته‌ها با پشتیبانی از متن فارسی.
* ذخیره DataFrame نهایی پردازش شده در فایل اکسل.

## ابزارها و کتابخانه‌های استفاده شده

* **Python 3**
* **Pandas:** برای خواندن، دستکاری و تحلیل داده‌های جدولی.
* **jdatetime:** برای کار با تاریخ هجری شمسی.
* **BeautifulSoup4:** برای پاکسازی و پارس کردن HTML.
* **Matplotlib:** برای رسم نمودار.
* **arabic_reshaper & python-bidi:** برای نمایش صحیح متن فارسی در نمودارها.
* **openpyxl:** مورد نیاز Pandas برای خواندن/نوشتن فایل‌های `.xlsx`.
* **(Numpy):** مورد استفاده غیرمستقیم توسط Pandas.
* **(Re):** برای تطبیق الگو در دسته‌بندی (اختیاری).

## نحوه اجرا

1.  مطمئن شوید پایتون ۳ و کتابخانه‌های ذکر شده نصب باشند (`pip install pandas jdatetime beautifulsoup4 matplotlib arabic-reshaper python-bidi openpyxl`).
2.  یک فایل اکسل ورودی با ساختار مشابه نمونه (سرستون‌ها در ردیف ۱۱) و با نام `sample_bank_statement.xlsx` در کنار اسکریپت قرار دهید.
3.  اسکریپت `bank_statement_cleaner.py` را اجرا کنید (`python bank_statement_cleaner.py`).
4.  خروجی شامل تحلیل‌ها در ترمینال چاپ شده و نمودار در پوشه `plots` و فایل اکسل نهایی در کنار اسکریپت ذخیره می‌شود.

## وضعیت پروژه

این یک پروژه نمونه برای نمایش مهارت‌های پاکسازی و تحلیل داده با پایتون است و مراحل اصلی آن با موفقیت تکمیل شده است.
